!function(){const t={},e=[["Array.prototype.includes","0","undefined","condition","visitor-gate"],["Storage.prototype.setItem","0",'json:"freeVideoFriendly"',"condition","freeVideoFriendlySlug"]],r=new Map([["perplexity.ai",0],["nebula.tv",1]]),n=new Map([]),s=new Map([]);function i(t="",e="",r=""){if(""===t)return;const n=c(),s=n.makeLogPrefix("trusted-replace-argument",t,e,r),i=parseInt(e,10)||0,h=n.getExtraArgs(Array.from(arguments),3),g=r.startsWith("repl:/")&&o(r.slice(5))||void 0,p=void 0===g&&l(!0,r,h),u=h.condition?n.patternToRegex(h.condition):/^/,f=t=>{if("this"===e)return t.thisArg;const{callArgs:r}=t,n=i>=0?i:r.length-i;return n<0||n>=r.length?void 0:(t.private={argpos:n},r[n])},d=(t,r)=>{"this"===e?r!==t.thisArg&&(t.thisArg=r):t.private&&(t.callArgs[t.private.argpos]=r)};a(t,(function(t){if(""===e)return n.uboLog(s,`Arguments:\n${t.callArgs.join("\n")}`),t.reflect();const r=f(t);if(void 0!==h.condition&&!1===n.RegExp_test.call(u,r))return t.reflect();const i=g&&"string"==typeof r?r.replace(g.re,g.replacement):p;return i!==r&&(d(t,i),n.uboLog(s,`Replaced argument:\nBefore: ${JSON.stringify(r)}\nAfter: ${i}`)),t.reflect()}))}function o(t){if(47!==t.charCodeAt(0))return;const e=function(...t){return new h(...t)}("/");e.nextArg(t,1);let r=t.slice(e.argBeg,e.argEnd);if(e.transform&&(r=e.normalizeArg(r)),""===r)return;e.nextArg(t,e.separatorEnd);let n=t.slice(e.argBeg,e.argEnd);if(e.separatorEnd===e.separatorBeg)return;e.transform&&(n=e.normalizeArg(n));const s=t.slice(e.separatorEnd);try{return{re:new RegExp(r,s),replacement:n}}catch{}}function a(t="",e=""){let r=globalThis,n=t;for(;;){const t=n.indexOf(".");if(-1===t)break;if(r=r[n.slice(0,t)],r instanceof Object==0)return;n=n.slice(t+1)}const s=r[n];if("function"!=typeof s)return;void 0===a.CtorContext&&(a.ctorContexts=[],a.CtorContext=class{constructor(...t){this.init(...t)}init(t,e){return this.callFn=t,this.callArgs=e,this}reflect(){const t=Reflect.construct(this.callFn,this.callArgs);return this.callFn=this.callArgs=this.private=void 0,a.ctorContexts.push(this),t}static factory(...t){return 0!==a.ctorContexts.length?a.ctorContexts.pop().init(...t):new a.CtorContext(...t)}},a.applyContexts=[],a.ApplyContext=class{constructor(...t){this.init(...t)}init(t,e,r){return this.callFn=t,this.thisArg=e,this.callArgs=r,this}reflect(){const t=Reflect.apply(this.callFn,this.thisArg,this.callArgs);return this.callFn=this.thisArg=this.callArgs=this.private=void 0,a.applyContexts.push(this),t}static factory(...t){return 0!==a.applyContexts.length?a.applyContexts.pop().init(...t):new a.ApplyContext(...t)}});const i=s.toString(),o=function(){return i}.bind(null),c={apply:(t,r,n)=>e(a.ApplyContext.factory(t,r,n)),get:(t,e)=>"toString"===e?o:Reflect.get(t,e)};s.prototype?.constructor===s&&(c.construct=function(t,r){return e(a.CtorContext.factory(t,r))}),r[n]=new Proxy(s,c)}function c(){if(t.safeSelf)return t.safeSelf;const e=globalThis,r={Array_from:Array.from,Error:e.Error,Function_toStringFn:e.Function.prototype.toString,Function_toString:t=>r.Function_toStringFn.call(t),Math_floor:Math.floor,Math_max:Math.max,Math_min:Math.min,Math_random:Math.random,Object,Object_defineProperty:Object.defineProperty.bind(Object),Object_defineProperties:Object.defineProperties.bind(Object),Object_fromEntries:Object.fromEntries.bind(Object),Object_getOwnPropertyDescriptor:Object.getOwnPropertyDescriptor.bind(Object),RegExp:e.RegExp,RegExp_test:e.RegExp.prototype.test,RegExp_exec:e.RegExp.prototype.exec,Request_clone:e.Request.prototype.clone,String_fromCharCode:String.fromCharCode,String_split:String.prototype.split,XMLHttpRequest:e.XMLHttpRequest,addEventListener:e.EventTarget.prototype.addEventListener,removeEventListener:e.EventTarget.prototype.removeEventListener,fetch:e.fetch,JSON:e.JSON,JSON_parseFn:e.JSON.parse,JSON_stringifyFn:e.JSON.stringify,JSON_parse:(...t)=>r.JSON_parseFn.call(r.JSON,...t),JSON_stringify:(...t)=>r.JSON_stringifyFn.call(r.JSON,...t),log:console.log.bind(console),logLevel:0,makeLogPrefix(...t){return this.sendToLogger&&`[${t.join(" ⁝ ")}]`||""},uboLog(...t){if(void 0!==this.sendToLogger&&void 0!==t&&""!==t[0])return this.sendToLogger("info",...t)},uboErr(...t){if(void 0!==this.sendToLogger&&void 0!==t&&""!==t[0])return this.sendToLogger("error",...t)},escapeRegexChars:t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),initPattern(t,e={}){if(""===t)return{matchAll:!0,expect:!0};const r=!0!==e.canNegate||!1===t.startsWith("!");!1===r&&(t=t.slice(1));const n=/^\/(.+)\/([gimsu]*)$/.exec(t);return null!==n?{re:new this.RegExp(n[1],n[2]||e.flags),expect:r}:void 0!==e.flags?{re:new this.RegExp(this.escapeRegexChars(t),e.flags),expect:r}:{pattern:t,expect:r}},testPattern(t,e){return!!t.matchAll||(t.re?this.RegExp_test.call(t.re,e)===t.expect:e.includes(t.pattern)===t.expect)},patternToRegex(t,e,r=!1){if(""===t)return/^/;const n=/^\/(.+)\/([gimsu]*)$/.exec(t);if(null===n){const n=this.escapeRegexChars(t);return new RegExp(r?`^${n}$`:n,e)}try{return new RegExp(n[1],n[2]||void 0)}catch{}return/^/},getExtraArgs(t,e=0){const r=t.slice(e).reduce(((t,e,r,n)=>{if(0==(1&r)){const e=n[r+1],s=/^\d+$/.test(e)?parseInt(e,10):e;t.push([n[r],s])}return t}),[]);return this.Object_fromEntries(r)},onIdle:(t,r)=>e.requestIdleCallback?e.requestIdleCallback(t,r):e.requestAnimationFrame(t),offIdle:t=>e.requestIdleCallback?e.cancelIdleCallback(t):e.cancelAnimationFrame(t)};if(t.safeSelf=r,void 0===t.bcSecret)return r;r.logLevel=t.logLevel||1;let n="",s="",i=0;r.toLogText=(t,...e)=>{if(0===e.length)return;const r=`[${document.location.hostname||document.location.href}]${e.join(" ")}`;return r===s&&t===n&&Date.now()-i<5e3?void 0:(n=t,s=r,i=Date.now(),r)};try{const n=new e.BroadcastChannel(t.bcSecret);let s=[];r.sendToLogger=(t,...e)=>{const i=r.toLogText(t,...e);if(void 0!==i)return void 0===s?n.postMessage({what:"messageToLogger",type:t,text:i}):void s.push({type:t,text:i})},n.onmessage=t=>{switch(t.data){case"iamready!":if(void 0===s)break;s.forEach((({type:t,text:e})=>n.postMessage({what:"messageToLogger",type:t,text:e}))),s=void 0;break;case"setScriptletLogLevelToOne":r.logLevel=1;break;case"setScriptletLogLevelToTwo":r.logLevel=2}},n.postMessage("areyouready?")}catch{r.sendToLogger=(t,...e)=>{const n=r.toLogText(t,...e);void 0!==n&&r.log(`uBO ${n}`)}}return r}function l(t,e,r={}){const n=c();let s;if("undefined"===e)s=void 0;else if("false"===e)s=!1;else if("true"===e)s=!0;else if("null"===e)s=null;else if("''"===e||""===e)s="";else if("[]"===e||"emptyArr"===e)s=[];else if("{}"===e||"emptyObj"===e)s={};else if("noopFunc"===e)s=function(){};else if("trueFunc"===e)s=function(){return!0};else if("falseFunc"===e)s=function(){return!1};else if("throwFunc"===e)s=function(){throw""};else if(/^-?\d+$/.test(e)){if(s=parseInt(e),isNaN(e))return;if(Math.abs(e)>32767)return}else{if(!t)return;if(e.startsWith("json:"))try{s=n.JSON_parse(e.slice(5))}catch{return}else if(e.startsWith("{")&&e.endsWith("}"))try{s=n.JSON_parse(e).value}catch{return}}if(void 0!==r.as){if("function"===r.as)return()=>s;if("callback"===r.as)return()=>()=>s;if("resolved"===r.as)return Promise.resolve(s);if("rejected"===r.as)return Promise.reject(s)}return s}class h{constructor(t=",",e=!1){this.separatorChar=this.actualSeparatorChar=t,this.separatorCode=this.actualSeparatorCode=t.charCodeAt(0),this.mustQuote=e,this.quoteBeg=0,this.quoteEnd=0,this.argBeg=0,this.argEnd=0,this.separatorBeg=0,this.separatorEnd=0,this.transform=!1,this.failed=!1,this.reWhitespaceStart=/^\s+/,this.reWhitespaceEnd=/\s+$/,this.reOddTrailingEscape=/(?:^|[^\\])(?:\\\\)*\\$/,this.reTrailingEscapeChars=/\\+$/}nextArg(t,e=0){const r=t.length;this.quoteBeg=e+this.leftWhitespaceCount(t.slice(e)),this.failed=!1;const n=t.charCodeAt(this.quoteBeg);if((34===n||39===n||96===n)&&(this.indexOfNextArgSeparator(t,n),this.argEnd!==r)){if(this.quoteEnd=this.argEnd+1,this.separatorBeg=this.separatorEnd=this.quoteEnd,this.separatorEnd+=this.leftWhitespaceCount(t.slice(this.quoteEnd)),this.separatorEnd===r)return this;if(t.charCodeAt(this.separatorEnd)===this.separatorCode)return this.separatorEnd+=1,this}return this.indexOfNextArgSeparator(t,this.separatorCode),this.separatorBeg=this.separatorEnd=this.argEnd,this.separatorBeg<r&&(this.separatorEnd+=1),this.argEnd-=this.rightWhitespaceCount(t.slice(0,this.separatorBeg)),this.quoteEnd=this.argEnd,this.mustQuote&&(this.failed=!0),this}normalizeArg(t,e=""){""===e&&(e=this.actualSeparatorChar);let r="",n=0;for(;-1!==(n=t.lastIndexOf(e));){r=t.slice(n)+r,t=t.slice(0,n);const e=this.reTrailingEscapeChars.exec(t);null!==e&&(r=(0!=(1&e[0].length)?e[0].slice(0,-1):e[0])+r,t=t.slice(0,-e[0].length))}return""===r?t:t+r}leftWhitespaceCount(t){const e=this.reWhitespaceStart.exec(t);return null===e?0:e[0].length}rightWhitespaceCount(t){const e=this.reWhitespaceEnd.exec(t);return null===e?0:e[0].length}indexOfNextArgSeparator(t,e){for(this.argBeg=this.argEnd=e!==this.separatorCode?this.quoteBeg+1:this.quoteBeg,this.transform=!1,e!==this.actualSeparatorCode&&(this.actualSeparatorCode=e,this.actualSeparatorChar=String.fromCharCode(e));this.argEnd<t.length;){const e=t.indexOf(this.actualSeparatorChar,this.argEnd);if(-1===e)return this.argEnd=t.length;if(!1===this.reOddTrailingEscape.test(t.slice(0,e)))return this.argEnd=e;this.transform=!0,this.argEnd=e+1}}}const g=[];try{let t=document.location.origin;if("null"===t){const e=document.location.ancestorOrigins;for(let r=0;r<e.length&&(t=e[r],"null"===t);r++);}const e=t.lastIndexOf("://");if(-1===e)return;g.push(...t.slice(e+3).split("."))}catch(t){}const p=g.length;if(0===p)return;const u=new Set,f=[];if(0!==s.size){for(let t=0;t<p;t++){const e=g.slice(t).join("."),r=s.get(e);r&&f.push(...r)}s.clear()}if(0!==r.size){const t=t=>{let e=r.get(t);if(void 0!==e){"number"==typeof e&&(e=[e]);for(const t of e)f.includes(t)||u.add(t)}};for(let e=0;e<p;e++)t(g.slice(e).join("."));t("*"),r.clear()}if(0!==n.size){const t=p-1;for(let e=0;e<t;e++)for(let r=t;r>e;r--){const t=g.slice(e,r).join(".");let s=n.get(t);if(void 0!==s){"number"==typeof s&&(s=[s]);for(const t of s)f.includes(t)||u.add(t)}}n.clear()}for(const t of u)try{i(...e[t])}catch(t){}e.length=0}();